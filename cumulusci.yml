minimum_cumulusci_version: "2.5.8"
project:
    name: core-sfdo-performance-tests
    package:
        name: core-sfdo-performance-tests

tasks:
    test_performance:
        description: Runs Robot Framework performance tests for basic SObjects
        class_path: cumulusci.tasks.robotframework.Robot
        group: Performance Tests

    test_performance_demo:
        class_path: cumulusci.tasks.robotframework.Robot
        options:
            suites: robot/core-sfdo-performance-tests
            test: Perftest - Insert 200 Contacts


    snowfakery:
        class_path: tasks.snowscale.Snowfakery
        options:
            # num_records: 45_000
            recipe: datasets/basic-salesforce.recipe.yml
            num_records_tablename: Account

    disable_duplicate_rules:
        class_path: cumulusci.tasks.metadata_etl.SetDuplicateRuleStatus
        options:
            active: False
            api_names: "*"


flows:
    test_performance_scratch:
        steps:
            1:
                task: disable_duplicate_rules

            2:
                task: deploy_post

            3:
                task: snowfakery
                options:
                    num_records: 40_000

            4:
                task: test_performance_demo

    test_performance_LDV:
        steps:
            1:
                task: test_performance
                options:
                    suites: robot/core-sfdo-performance-tests
